<%- partial ('../shared/_navbar.ejs') %>
<% var topic = data; %>
<section data-package-name="<%=topic.package_version.package_name%>" class="packageData" itemscope itemtype="http://schema.org/SoftwareApplication"></section>
<section class="topic">
  <div class="container-fluid">
    <header>
      <h1><%- topic.name %><span>From <a href="<%- topic.package_version.uri %>"><%- topic.package_version.package_name %> v<%- topic.package_version.version %></a></span></h1>
      <div class="topic--package pull-right">
        <div class="topic--package-maintainer">
          <div class="topic--package-name">
          <p>In package <a href="<%- topic.package_version.uri %>"><%- topic.package_version.package_name %> v<%- topic.package_version.version %></a></p>
          </div>
          <% if(topic.package_version.maintainer) { %>
          <div class="maintainer pull-left">
            By<i class="fa fa-user" aria-hidden="true"></i>
            <div class="maintainer neg-top-margin pull-right">
                <div class="data">
                <a itemprop="creator" href="<%= topic.package_version.maintainer.uri %>">
                      <%= topic.package_version.maintainer.name %></a>
                      <a href="mailto:<%= topic.package_version.maintainer.email %>">
                      <i class="fa fa-envelope" aria-hidden="true"></i></a>
                </div>
              <p>Maintainer</p>
            </div>
          </div>
          <% } %>
        </div>
        <div class="downloads">
          <span class="downloads-nr percentile-task" data-url="/api<%= path %>/percentile" >
            <span class='percentile'>0th</span>
          </span>
          <p>Percentile</p>
        </div>
      </div>
    </header>

    <section>
      <h5><%- topic.title %></h5>
      <p><%- topic.description %></p>
    </section>

   <% if(topic.keywords && topic.keywords.length>0){ %>
      <section class="topic--keywords">
        <dl>
          <dt>Keywords</dt>
          <% var keywords = topic.keywords.map(function(keyword) {
            return '<a href="/search/keywords/' + encodeURIComponent(keyword.name) + '">' + keyword.name + '</a>';
          }) -%>
          <dd><%- keywords.join(', ') %></dd>
        </dl>
      </section>
    <%}%>

   <% if(topic.usage) { %>
    <section>
      <h5 class="topic--title">Usage</h5>
      <pre><code class="R"><%- topic.usage %></code></pre>
    </section>
  <% } %>

    <%if(topic.arguments && topic.arguments.length>0){%>
      <section class="topic--arguments">
        <h5 class="topic--title">Arguments</h5>
        <dl>
          <% for(var i = 0; i < topic.arguments.length; i++) { %>
            <dt><%- topic.arguments[i].name %></dt>
            <dd><%- topic.arguments[i].description %></dd>
          <% } %>
        </dl>
      </section>
    <%}%>

    <!-- Other info -->


    <% if(topic.details) { %>
      <section>
        <h5 class="topic--title">Details</h5>
        <p><%- topic.details %></p>
      </section>
    <% } %>

    <% if(topic.value) { %>
      <section class="topic--value">
        <h5 class="topic--title">Value</h5>
        <p><%- topic.value %></p>
      </section>
    <% } %>


    <% if(topic.note) { %>
      <section>
        <h5 class="topic--title">Note</h5>
        <p><%- topic.note %></p>
      </section>
    <% } %>

    <% if(topic.sections) { %>
      <% for(var i = 0; i < topic.sections.length; i++) { %>
        <% var section = topic.sections[i]; %>
        <section>
          <h5 class="topic--title"><%- section.name %></h5>
          <p><%- section.description %></p>
        </section>
      <% } %>

    <% } %>

    <% if(topic.references) { %>
      <section>
        <h5 class="topic--title">References</h5>
        <p><%- topic.references %></p>
      </section>
    <% } %>


    <% if(topic.seealso) { %>
      <section>
        <h5 class="topic--title">See Also</h5>
        <p><%- topic.seealso %></p>
      </section>
    <% } %>



    <% if(topic.examples) { %>
      <section>
        <h5 class="topic--title">Examples</h5>
        <pre><code class="nohighlight R exampleR" data-package-name = <%- topic.package_version.package_name %>><%- topic.examples %></code></pre>
      </section>
      <% if(inViewerPane){ %>
        <section>
          <button type="button" id="js-examples" class="btn btn-primary js-external">Run examples</button>
        </section>
      <% }%>
    <% } %>

    <small>
      <i> Documentation reproduced from package <span itemprop="name"><%- topic.package_version.package_name %></span>, version <span itemprop="version"><%- topic.package_version.version %></span>,
      License: <%= topic.package_version.license %>
      </i>
    </small>

    <% var reviewPostAction = '/api/topics/' + data.id + '/reviews' %>
    <%- include ../shared/_post_review.ejs %>
  </div>
</section>
<%- partial ('../shared/_footer.ejs') %>
